## Практическое задание #1. Работа с облачной консолью Yandex Cloud

Список задач практического задания:
* 1.1 [Вход в облачную консоль Yandex Cloud](#h1-1)
* 1.2 [Создание виртуальной облачной сети (VPC)](#h1-2)
* 1.3 [Организация сетевой связности в Интернет](#h1-3)
* 1.4 [Создание сервисного аккаунта (SA)](#h1-4)
* 1.5 [Создание виртуальной машины (ВМ)](#h1-5)
* 1.6 [Подключение к ВМ по протоколу SSH](#h1-6)


### 1.1 Вход в облачную консоль Yandex Cloud <a id="h1-1"/></a>
Открыть в браузере адрес облачной консоли Yandex Cloud [https://console.cloud.yandex.ru](https://console.cloud.yandex.ru)

`Внимание!` Если вы ранее уже заходили в облачную консоль Yandex Cloud, и она показывается вам снова, то необходимо из неё выйти, нажав на значок `"Учётная запись"` в левом нижнем углу экрана и выбрать `"Выйти"`, перед тем как продолжить.

Нажать на синюю кнопку `"Войти в Яндекс ID"`

<p align="left">
    <img src="./images/lab01-11.png" alt="" width="600"/>
</p>

Ввести имя пользователя в формате e-mail адреса, которое вы получили перед началом практикума, в поле `"Логин или email"` и нажать на кнопку `Войти`.

<p align="left">
    <img src="./images/lab01-12.png" alt="" width="300"/>
</p>

Ввести пароль пользователя, который вы получили перед началом практикума, в поле `"Введите пароль"` и нажать на кнопку `Войти`.

<p align="left">
    <img src="./images/lab01-13.png" alt="" width="300"/>
</p>

Принять условия пользовательского соглашения Яндекса и согласиться на обработку своих персональных данных, нажав на кнопку `"Завершить регистрацию"`.

<p align="left">
    <img src="./images/lab01-14.png" alt="" width="600"/>
</p>

Нажать на кнопку `"Войти"`. В случае возникновения сообщения об ошибке после нажатия на кнопку, обновите страницу в браузере.

<p align="left">
    <img src="./images/lab01-15.png" alt="" width="600"/>
</p>

При получении уведомления от облачной консоли с предложением протестировать облачный сервис, выбрать `"Пропустить"` в появившемся окне с уведомлением.

<p align="left">
    <img src="./images/lab01-16.png" alt="" width="200"/>
</p>

`Поздравляем! Теперь вы можете пользоваться Yandex Cloud!`


### 1.2 Создание виртуальной облачной сети (VPC) <a id="h1-2"/></a>

Перейти в дашборд облачного каталога (значок домика). Для этого в левой части экрана выбрать имя каталога. Имя каталога будет совпадать с первой частью имени пользователя, которое использовалось для входа в облачную консоль. В списке сервисов выбрать `"Virtual Private Cloud"`.

<p align="left">
    <img src="./images/lab01-21.png" alt="" width="600"/>
</p>

Нажать на кнопку `"Создать сеть"`, после чего заполнить открывшуюся форму с параметрами виртуальной сети в которой указать имя сети, например `"project-net"`, убедиться что опция `"Создать подсети"` выбрана (стоит галочка) и нажать на кнопку `"Создать сеть"`. Описание сети вводить не требуется, но рекомендуется для целей документирования.

Виртуальная сеть VPC существует на уровне облачного каталога, поэтому допускается использование одинаковых имен сетей в разных каталогах.

<p align="left">
    <img src="./images/lab01-22.png" alt="" width="400"/>
</p>

Убедиться в том, что виртуальная сеть в каталоге успешно создана.

<p align="left">
    <img src="./images/lab01-23.png" alt="" width="600"/>
</p>

Перейти в настройки виртуальной сети и увидеть, что кроме сети были созданы 3 подсети (по одной подсети для каждой зоны доступности).


### 1.3 Организация сетевой связности в Интернет <a id="h1-3"/></a>

План действий:
1. Создать шлюз (NAT Gateway)
2. Создать таблицу маршрутизации
3. Добавить в таблицу маршрутизации маршрут `0.0.0.0/0` с next-hop через шлюз
4. Привязать таблицу маршрутизации к нужным подсетям

Перейти в дашборд облачного каталога (значок домика). Выбрать сервис `"Virtual Private Cloud"` далее выбрать только что созданную сеть и в меню слева выбрать значок `"Шлюзы"` и затем нажать на кнопку `"Создать шлюз"`.

<p align="left">
    <img src="./images/lab01-31.png" alt="" width="600"/>
</p>

Заполнить поля формы `"Создание шлюза"` следующим образом:
* Имя: имя шлюза, например, `"nat-gw"`
* Описание: описание шлюза (не обязательно)

и нажать на кнопку `"Сохранить"`.

В меню слева выбрать значок `"Таблицы маршрутизации"` и нажать на кнопку `"Создать таблицу маршрутизации"`.

<p align="left">
    <img src="./images/lab01-32.png" alt="" width="600"/>
</p>

Заполнить поля формы `"Создание таблицы маршрутизации"` следующим образом:
* Имя: имя таблицы маршрутизации, например, `"nat-gw-rt"`.
* Описание: описание таблицы маршрутизации (не обязательно)
* Сеть: выбрать из списка сеть где таблица маршрутизации будет создана, например, `"project-net"`.

и нажать на кнопку `"Добавить маршрут"`.

<p align="left">
    <img src="./images/lab01-33.png" alt="" width="400"/>
</p>

Заполнить поля формы `"Добавление статического маршрута"` следующим образом:
* Префикс назначения: `0.0.0.0/0`
* Next hop: `Шлюз`
* Шлюз: выбрать из списка созданный ранее шлюз, например, `nat-gw`

и нажать на кнопку `"Добавить"` и далее нажать на кнопку `"Создать таблицу маршрутизации"`.

Убедиться, что таблица маршрутизации создалась.

<p align="left">
    <img src="./images/lab01-34.png" alt="" width="600"/>
</p>

В меню слева выбрать значок `"Подсети"` далее справа от нужной подсети нажать на троеточие `"..."`
и в открывшемся меню выбрать пункт `"Привязать таблицу маршрутизации"`, после чего выбрать
нужную таблицу маршрутизации из списка, например, `"nat-gw-rt"` и нажать на кнопку `"Привязать"`.

<p align="left">
    <img src="./images/lab01-35.png" alt="" width="600"/>
</p>

Убедиться в том, что таблица маршрутизации привязана к нужной подсети.

<p align="left">
    <img src="./images/lab01-36.png" alt="" width="600"/>
</p>

Повторить при необходимости для всех подсетей, которым нужен доступ в Интернет.


### 1.4 Создание сервисного аккаунта (SA) <a id="h1-4"/></a>

Перейти в дашборд облачного каталога. 

<p align="left">
    <img src="./images/lab01-41.png" alt="" width="600"/>
</p>

Выбрать в верхнем меню `"Сервисные аккаунты"` и нажать на кнопку `"Создать сервисный аккаунт"`.

<p align="left">
    <img src="./images/lab01-42.png" alt="" width="600"/>
</p>

Заполнить поля формы `"Создание сервисного аккаунта"` следующим образом:
* Имя: `webinar-sa`. Сервисные аккаунты (SA) создаются на уровне облака, а не облачного каталога, поэтому их имена не должны повторяться в границах всего облака.
* Описание: краткое описание полномочий данного SA, например, `"SA для практикума"`.
* Роли в каталоге: нажать на значок плюса `"Добавить роль"` и выбрать `"admin"` в выпадающем списке.

нажать на кнопку `"Создать"`.

<p align="left">
    <img src="./images/lab01-43.png" alt="" width="400"/>
</p>

Убедиться в том, что сервисный аккаунт (SA) успешно создан. 

<p align="left">
    <img src="./images/lab01-44.png" alt="" width="600"/>
</p>

`Важно!` Если вы попытаетесь создать SA с именем, которое уже есть в облаке, вы получите сообщение об ошибке.


### 1.5 Создание виртуальной машины (ВМ) <a id="h1-5"/></a>

Перейти в дашборд облачного каталога. В списке сервисов выбрать `"Compute Cloud"`.

<p align="left">
    <img src="./images/lab01-51.png" alt="" width="600"/>
</p>

На открывшейся странице нажать кнопку `"Создать ВМ"` и заполнить параметры виртуальной машины (ВМ):

* Имя: `infra-vm`
* Зона доступности: `ru-central1-b`
* Выбор образа/загрузочного диска: `Cloud Marketplace > Посмотреть больше`. В поле ввода "Поиск инструментов" ввести `toolbox` и выбрать продукт `Yandex Cloud Toolbox`. В открывшемся окне с описанием продукта нажать кнопку `Использовать`.
* vCPU: `2`
* RAM: `4 Гб`
* Подсеть: `project-net / project-net-ru-central1-b`
* Публичный адрес: `Автоматически`
* Сервисный аккаунт: `webinar-sa` - имя сервисного аккаунта, созданного ранее
* Логин: `admin` - имя пользователя, который будет использоваться для подключения к ВМ по протоколу SSH
* SSH-ключ: Открытый ключ SSH (public SSH key), который будет загружен на ВМ при её создании и будет использоваться для аутентификации пользователя, имя которого задано параметром `Логин`. Должен быть сгенерирован перед началом практикума. Подробная инструкцию по генерации и использованию SSH ключей в Yandex Cloud [здесь](https://cloud.yandex.ru/docs/managed-kubernetes/operations/node-connect-ssh). 

  `Важно!` При заполнении поля `SSH-ключ` после строки ключа необходимо добавить пустую строку (нажать Enter).

после заполнения параметров нажать на кнопку `"Создать ВМ"`.

Убедиться в успешном создании виртуальной машины.

<p align="left">
    <img src="./images/lab01-52.png" alt="" width="600"/>
</p>

### 1.6 Подключение к ВМ по протоколу SSH <a id="h1-6"/></a>

[Инструкции по подключению к ВМ в Yandex Cloud по протоколу SSH](https://cloud.yandex.ru/docs/managed-kubernetes/operations/node-connect-ssh).

Подключиться к созданной ВМ по протоколу SSH:
```bash
ssh admin@<зарезервированный-ip-адрес>
```

Вывод терминала после подключения к ВМ будет примерно такой:
```
Warning: Permanently added '130.193.42.209' (ED25519) to the list of known hosts.
Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-120-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

admin@infra-vm:~$
```

`Поздравляем! Вы успешно справились с заданием!`

### [<< оглавление](../README.md) || [задание 2 >>](../lab-02-yc/README.md)
